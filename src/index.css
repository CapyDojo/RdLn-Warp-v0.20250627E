@tailwind base;
@tailwind components;
@tailwind utilities;

/* Enhanced Glassmorphic Design with Vivid Dynamic Effects */
:root {
  /* Default fallback values - will be overridden by ThemeContext */
  --glass-opacity: 0.8;
  --glass-blur: 24px;
  --glass-shadow: 0 12px 48px rgba(31, 38, 135, 0.5);
  --glass-transition: 300ms;
  --glass-border: rgba(255, 255, 255, 0.25);
  --gradient-start: rgba(255, 255, 255, 0.35);
  --gradient-middle: rgba(255, 255, 255, 0.25);
  --gradient-end: rgba(255, 255, 255, 0.15);
  --gradient-accent: rgba(255, 255, 255, 0.4);
}

/* Clean Glass Panel - Use unified opacity system only */
.glass-panel {
  position: relative;
  /* Remove conflicting background - let glassmorphism.css handle it */
  border-radius: 12px;
  overflow: hidden;
}

/* Glass Panel Hover Effects */
.glass-panel:hover {
  transform: translateY(-2px);
  box-shadow: var(--glass-shadow), 0 4px 16px rgba(0, 0, 0, 0.1);
  border-color: var(--gradient-accent);
}

/* Glass Panel Clean Hover Effects - No Banding */
.glass-panel {
  transition: all 400ms cubic-bezier(0.4, 0, 0.2, 1);
}

.glass-panel:hover {
  backdrop-filter: blur(calc(var(--glass-blur) * 1.1)) saturate(1.1);
  -webkit-backdrop-filter: blur(calc(var(--glass-blur) * 1.1)) saturate(1.1);
  border-color: rgba(255, 255, 255, 0.4);
}

/* DEFINITIVE FIX: Force transparent base layers */
html {
  height: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
}

body {
  height: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
  /* Background will be set by ThemeContext with !important */
}

#root {
  min-height: 100vh !important;
  background: transparent !important;
}

/* FORCE REMOVE ANY CONFLICTING STYLES */
* {
  box-sizing: border-box;
}

/* Global text legibility improvements - WCAG AAA compliance with 10% safety margin */

/* Professional theme global text */
[data-theme="professional"] {
  --text-body: #1e293b;
  --text-header: #0f172a;
  --text-secondary: #475569;
  --text-interactive: #ea580c;
  --text-success: #1d4ed8;
  --text-on-glass: #1e293b;
}

/* Bamboo theme global text */
[data-theme="bamboo"] {
  --text-body: #2e0e01;
  --text-header: #2e0e01;
  --text-secondary: #2e0e01;
  --text-interactive: #2e0e01;
  --text-success: #2e0e01;
  --text-on-glass: #2e0e01;
}

/* Apple Light theme global text */
[data-theme="apple-light"] {
  --text-body: #111827;
  --text-header: #1f2937;
  --text-secondary: #4b5563;
  --text-interactive: #7c3aed;
  --text-success: #0284c7;
  --text-on-glass: #111827;
}

/* Apple Dark theme global text */
[data-theme="apple-dark"] {
  --text-body: #f5f5f5;
  --text-header: #ffffff;
  --text-secondary: #d4d4d4;
  --text-interactive: #a78bfa;
  --text-success: #80deea;
  --text-on-glass: #f5f5f5;
}

/* Kyoto theme global text - Dark autumn night inspired */
[data-theme="kyoto"] {
  --text-body: #f8b4b4;      /* CORRECT peach color for all body text including input panels */
  --text-header: #86efac;    /* Green for panel titles */
  --text-secondary: #fef7e6; /* Tatami wheat off-white for secondary text */
  --text-interactive: #f8b4b4; /* Light maple red - interactive elements */
  --text-success: #bbf7d0;   /* Light forest green - success states */
  --text-on-glass: #f8b4b4; /* CORRECT peach for glass panels */
  
  /* BRUTE FORCE: Override Tailwind neutral colors directly */
  --color-neutral-800: 248 180 180; /* Force neutral-800 to be CORRECT peach RGB */
  --color-neutral-900: 248 180 180; /* Force neutral-900 to be CORRECT peach RGB */
  --tw-text-opacity: 1;
}

/* New York theme global text */
[data-theme="new-york"] {
  --text-body: #fafafa;
  --text-header: #ffffff;
  --text-secondary: #e0e0e0;
  --text-interactive: #ffb74d;
  --text-success: #4dd0e1;
  --text-on-glass: #fafafa;
}

/* Global text hierarchy classes */
.text-body,
textarea,
input[type="text"],
input[type="email"],
input[type="password"],
p,
span:not(.text-header):not(.text-secondary) {
  color: var(--text-body) !important;
  line-height: 1.6 !important;
}

.text-header,
h1, h2, h3, h4, h5, h6 {
  color: var(--text-header) !important;
  font-weight: 600 !important;
  line-height: 1.4 !important;
}

.text-secondary,
.text-sm,
.text-xs,
label {
  color: var(--text-secondary) !important;
}

.text-interactive,
button,
a,
.cursor-pointer {
  color: var(--text-interactive) !important;
}

.text-success,
.text-active {
  color: var(--text-success) !important;
}

/* Enhanced Button Text Legibility - Universal Font Weight Enhancement */
button.enhanced-button,
.enhanced-button,
button.bg-theme-primary-600,
button.bg-theme-accent-600,
button.bg-theme-neutral-600,
button.bg-theme-accent-500,
button.bg-theme-neutral-100,
button.bg-theme-neutral-200 {
  font-weight: 700 !important;
  letter-spacing: 0.025em !important;
  text-rendering: optimizeLegibility !important;
}

/* Universal white text enforcement for dark buttons */
.enhanced-button.text-white,
button.enhanced-button.text-white,
.bg-theme-primary-600.text-white,
.bg-theme-accent-600.text-white,
.bg-theme-neutral-600.text-white {
  color: #ffffff !important;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
}

/* Force whitespace preservation in redline output components */
.libertinus-math-output,
.libertinus-math-output span,
.chunk-container span,
.semantic-chunk span {
  white-space: pre-wrap !important;
  word-wrap: break-word !important;
}

/* Universal dark text enforcement for light buttons */
.enhanced-button:not(.text-white):not([class*="bg-theme-primary-"]):not([class*="bg-theme-accent-"]):not([class*="bg-theme-neutral-6"]),
.bg-theme-neutral-100:not(.text-white),
.bg-theme-neutral-200:not(.text-white) {
  color: #1f2937 !important;
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5) !important;
}

/* Enhanced readability for glass panels */
.glass-panel .text-body,
.glass-panel textarea,
.glass-panel input,
.glass-panel p,
.glass-panel span:not(.text-header):not(.text-secondary) {
  color: var(--text-on-glass) !important;
  font-weight: 500 !important;
}

/* Legal document specific improvements */
.libertinus-math-text {
  color: var(--text-body) !important;
  font-weight: 500 !important;
  line-height: 1.7 !important;
  letter-spacing: 0.01em !important;
}

/* Focus states for accessibility */
button:focus,
a:focus,
input:focus,
textarea:focus {
  outline: 2px solid var(--text-interactive) !important;
  outline-offset: 2px !important;
}

/* Floating Header - Ensure it stays fixed during scroll */
.floating-header {
  position: fixed !important;
  top: 1rem !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  z-index: 9999 !important;
  width: 100% !important;
  max-width: 72rem !important;
  padding-left: 1rem !important;
  padding-right: 1rem !important;
}

/* Selection states */
::selection {
  background: var(--text-interactive) !important;
  color: white !important;
}

/* ENSURE BACKDROP-FILTER WORKS */
.glass-panel {
  isolation: isolate !important;
}

/* Glass Panel Sub-sections - Use unified opacity system */
.glass-panel-header-footer {
  background: transparent !important;
  border-bottom: 1px solid rgba(255, 255, 255, var(--glass-subtle));
}

/* Text areas get higher opacity for better readability */
.glass-content-panel .glass-panel-inner-content {
  background: rgba(255, 255, 255, 0.15) !important; /* Higher opacity for text readability */
}

/* All other glass-panel-inner-content keeps base opacity */
.glass-panel-inner-content {
  background: rgba(255, 255, 255, var(--glass-subtle)) !important;
}

/* Premium Animation Effects */
@keyframes glassShimmer {
  0% {
    transform: translateX(-100%);
  }
  50% {
    transform: translateX(100%);
  }
  100% {
    transform: translateX(100%);
  }
}

.glass-panel-premium::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.05);
  opacity: 0;
  transform: translateX(-100%);
  animation: glassShimmer 3s infinite;
  pointer-events: none;
}

/* Enhanced Focus States */
.glass-panel:focus-within {
  border-color: var(--gradient-accent);
  box-shadow: var(--glass-shadow), 0 0 0 3px rgba(var(--color-primary-500-rgb), 0.1);
}
